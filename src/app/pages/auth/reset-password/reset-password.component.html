<div class="reset-password-page">
  <!-- Background decoration -->
  <div class="bg-decoration">
    <div class="shape shape-1"></div>
    <div class="shape shape-2"></div>
    <div class="shape shape-3"></div>
  </div>

  <!-- Reset Password container -->
  <div class="reset-password-container">
    <!-- Logo section -->
    <div class="reset-password-logo">
      <div class="logo-icon">
        <img src="../../../../assets/icons/icon.svg" alt="finan-icon" />
      </div>
      <h1 class="logo-title">FinanSmart</h1>
      <p class="logo-subtitle">Recupera tu cuenta</p>
    </div>

    <!-- Reset Password card -->
    <div class="reset-password-card">
      @if (!showResetForm) {
        <div class="card-header">
          <h2 class="card-title">Restablecer Contraseña</h2>
          <p class="card-subtitle">
            Ingresa tu correo electrónico para recibir un código de verificación
          </p>
        </div>

        <!-- Reset Password form -->
        <form [formGroup]="form" (ngSubmit)="resetPassword()" class="reset-password-form">
          <!-- Email input -->
          <fs-input
            label="Correo electrónico"
            type="email"
            formControlName="email"
            id="email"
            placeholder="tu@email.com"
            [width]="'100%'"
          ></fs-input>

          @if (errorMessage) {
            <span class="error-message">
              <span class="material-icons">error</span>
              {{ errorMessage }}
            </span>
          }

          @if (successMessage) {
            <span class="success-message">
              <span class="material-icons">check_circle</span>
              {{ successMessage }}
            </span>
          }

          <!-- Submit button -->
          <fs-button
            type="submit"
            label="Enviar Código"
            [disabled]="buttonDisabled"
            [loading]="loading"
            [width]="'100%'"
          ></fs-button>
        </form>

        <div class="auth-links">
          <span>
            ¿Recordaste tu contraseña?
            <a (click)="goToLogin()" class="link">Iniciar sesión</a>
          </span>
        </div>
      } @else {
        <div class="card-header">
          <h2 class="card-title">Nueva Contraseña</h2>
          <p class="card-subtitle">
            Ingresa el código enviado a {{ userEmail }} y tu nueva contraseña
          </p>
        </div>

        <!-- Confirmation form -->
        <form
          [formGroup]="resetForm"
          (ngSubmit)="confirmReset()"
          class="reset-password-form"
        >
          <!-- Code input -->
          <fs-input
            label="Código de verificación"
            type="text"
            formControlName="code"
            id="code"
            placeholder="123456"
            [width]="'100%'"
          ></fs-input>

          <!-- New Password input -->
          <fs-input
            label="Nueva contraseña"
            type="password"
            formControlName="newPassword"
            id="newPassword"
            placeholder="Mínimo 6 caracteres"
            [width]="'100%'"
          ></fs-input>

          <!-- Confirm Password input -->
          <fs-input
            label="Confirmar contraseña"
            type="password"
            formControlName="confirmPassword"
            id="confirmPassword"
            placeholder="Repite tu contraseña"
            [width]="'100%'"
          ></fs-input>

          @if (errorMessage) {
            <span class="error-message">
              <span class="material-icons">error</span>
              {{ errorMessage }}
            </span>
          }

          @if (successMessage) {
            <span class="success-message">
              <span class="material-icons">check_circle</span>
              {{ successMessage }}
            </span>
          }

          <!-- Submit button -->
          <fs-button
            type="submit"
            label="Restablecer Contraseña"
            [disabled]="buttonDisabled"
            [loading]="loading"
            [width]="'100%'"
          ></fs-button>

          <!-- Resend code link -->
          <div class="resend-code">
            <span>¿No recibiste el código? </span>
            <a class="link" (click)="resendCode()">Reenviar</a>
          </div>
        </form>

        <!-- Auth links -->
        <div class="auth-links">
          <a class="link" (click)="goToLogin()">Volver al inicio de sesión</a>
        </div>
      }
    </div>
  </div>
</div>
